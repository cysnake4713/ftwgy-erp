<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
        <record id="group_doc_trans_user" model="res.groups">
            <field name="name">公文上传</field>
            <field name="category_id" ref="base.module_category_wenjianliuzhuan"/>
        </record>
        <record id="group_doc_trans_principal" model="res.groups">
            <field name="name">校长</field>
            <field name="category_id" ref="base.module_category_wenjianliuzhuan"/>
        </record>
        <record id="group_doc_trans_vice_principal" model="res.groups">
            <field name="name">副校长</field>
            <field name="category_id" ref="base.module_category_wenjianliuzhuan"/>
        </record>
        <record id="group_doc_trans_department" model="res.groups">
            <field name="name">部门领导</field>
            <field name="category_id" ref="base.module_category_wenjianliuzhuan"/>
        </record>
        <record id="group_doc_trans_admin" model="res.groups">
            <field name="name">管理员</field>
            <field name="category_id" ref="base.module_category_wenjianliuzhuan"/>
        </record>

        <record model="ir.rule" id="rule_group_doc_trans_user_draft_state">
            <field name="name">ft doc trans user, deletable in draft state</field>
            <field name="model_id" ref="ft_doc_transform.model_ft_document_transform"/>
            <field name="domain_force">[('state', 'in',['draft'])]</field>
            <field name="groups" eval="[(4, ref('ft_doc_transform.group_doc_trans_user'))]"/>
        </record>
        <record model="ir.rule" id="rule_group_doc_trans_user_not_draft_state">
            <field name="name">ft doc trans user, not deletable in draft state</field>
            <field name="model_id" ref="ft_doc_transform.model_ft_document_transform"/>
            <field name="domain_force">[('state', 'not in',['draft'])]</field>
            <field name="groups" eval="[(4, ref('ft_doc_transform.group_doc_trans_user'))]"/>
            <field name="perm_unlink" eval="False"/>
        </record>


        <record model="ir.rule" id="rule_group_user_readable">
            <field name="name">老师只能看到和自己相关的公文</field>
            <field name="model_id" ref="ft_doc_transform.model_ft_document_transform"/>
            <field name="domain_force">
                [
                '&amp;',
                ('state', 'in', ['finish_teacher','finish'])
                '|','|',
                ('request_department_teacher_users', '=', user.id),
                ('request_vice_department_teacher_users', '=', user.id),
                ('department_comment_user', '=', user.id)
                ]
            </field>
            <field name="groups" eval="[(4, ref('base.group_user'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record model="ir.rule" id="rule_group_doc_trans_principal">
            <field name="name">校长可以看到自己</field>
            <field name="model_id" ref="ft_doc_transform.model_ft_document_transform"/>
            <field name="domain_force">
                [
                ('state', '!=', 'draft')
                ]
            </field>
            <field name="groups" eval="[(4, ref('ft_doc_transform.group_doc_trans_principal'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record model="ir.rule" id="rule_group_doc_trans_vice_principal">
            <field name="name">副校长可以看到自己</field>
            <field name="model_id" ref="ft_doc_transform.model_ft_document_transform"/>
            <field name="domain_force">
                [
                '&amp;',
                ('state', 'in', ['vice_principal','department','finish_teacher','finish']),
                '|',
                ('request_principal_user', '=', user.id),
                ('request_principal_vice_principal', '=', user.id),
                ]
            </field>
            <field name="groups" eval="[(4, ref('ft_doc_transform.group_doc_trans_vice_principal'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record model="ir.rule" id="rule_group_doc_trans_department">
            <field name="name">部门领导可以看到自己</field>
            <field name="model_id" ref="ft_doc_transform.model_ft_document_transform"/>
            <field name="domain_force">
                [
                '&amp;',
                ('state', 'in', ['department','finish_teacher','finish']),
                '|',
                ('request_department_users', '=', user.id),
                ('request_vice_department_users', '=', user.id),
                ]
            </field>
            <field name="groups" eval="[(4, ref('ft_doc_transform.group_doc_trans_department'))]"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>
    </data>
</openerp>